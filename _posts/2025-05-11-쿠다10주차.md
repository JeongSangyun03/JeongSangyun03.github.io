---
layout : post
title : 쿠다ML심화 11주차
categories : ML심화
---
# CH1. 추천시스템
## 1.1 추천 시스템
**추천시스템** : 여러 후보 가운데 ***가치 있는 것***을 선정하고 의사 결정을 지원하는 기술

**가치**를 정의하는 방법에 따라 다양한 추천 알고리즘 제안됨

ex)

1. 상위 10개 인기 아이템을 선택하는 방법 → 계산 속도 빠르지만 예측도 떨어짐
2. 사용자가 과거에 구입한 것과 유사한 것 선택하는 방법 → 축적된 데이터 양이 충분해야 예측 정확도 향상 가능

**∴** 비즈니스 목적에 맞춰 알고리즘을 적절하게 선택해서 사용해야 한다.

**의사결정을 지원한다** : 선택한 아이템을 사용자가 실제로 열람 또는 구입하도록 제시하는 것

## 1.2 추천 시스템의 역사
(생략하겠습니다.)
## 1.3 추천 시스템의 종류
추천 시스템의 3요소 : 입력 (데이터 입력), 프로세스 (추천 설계), 출력 (추천 결과 제시)

![image](https://github.com/user-attachments/assets/e91eec42-a170-4446-b3f4-d4c6f7caa3bf)

### 1.3.1 입력 (데이터 입력)
추천 시스템에 사용하는 데이터 : **콘텐츠** & **인터랙션** 

**사용자와 아이템의 콘텐츠 정보**

사용자의 콘텐츠 정보 : (나이, 성별, 주소 등) 프로필 정보, (서비스에 따라) 회원 등록 시 선호하는 카테고리 or 가격대를 물어보는 설문

아이템의 콘텐츠 정보 : 카테고리, 상품 설명문, 발매일, 가격, 제작자 등 → 이들은 기본적으로 사용자나 아이템이 추가되었을 때 서로 연결되는 콘텐츠 정보

⇥ 콘텐츠 정보를 이용하는 추천 : **내용 기반 필터링** → 신규 사용자나 신규 아이템 등 행동 이력 데이터가 없을 때 추천

※ 사용자, 신규 아이템 데이터 小로 인해 추천이 어려워지는 문제 : **콜드 스타트 문제**

**사용자와 아이템의 인터랙션 정보**

인터랙션 정보 : 사용자가 서비스 안에서 행동한 이력 데이터 (열람, 구입, 북마크, 평가 등) → 사용자가 서비스 안에서 행동할 수록 축적됨

⇥ 인터랙션 정보를 사용하는 추천 : **협조 필터링** → 실시간으로 데이터가 업데이트 되어 사용자의 기호를 더 반영하여 추천

### 1.3.2 프로세스 (추천 설계)
입력 데이터를 활용해 추천하는 방법 3가지 : 개요 추천 (개인화 없음), 연관 아이템 추천, 개인화 추천

**개요 추천 (개인화 없음)** : 모든 사용자에게 동일한 내용을 제시

미디어에서 정보의 신규성이 중요하여 신규 정보순으로 가격이 높을 때, 모두가 보고 있는 정보를 보고 싶다는 욕구로 인해 인기순으로 가격이 높을 때, 뉴스 사이트와 같이 아이템이 빠르게 바뀔 때

**연관 아이템 추천** : 각 아이템 사이의 유사도 사용

아이템 유사도 판단의 관점 2개

1. 비슷한 아이템일 가능성이 높을 때

2. 함께 구입될 만한 아이템일 가능성이 높을 때

경우에 따라 구매하는 아이템과 관련해 표시해야 할 아이템 종류 다르므로 이를 고려해 연관 아이템 추천 구조 설계하는 것이 중요!

+ 특정 시기에 사람들이 많이 구입하는 아이템은 모든 아이템의 추천 아이템이 될 수 있으므로, 인기 아이템 영향 제거해야 하는 경우도 존재 : **해리포터 문제**

**개인화 추천** : 사용자의 프로필, 행동 이력을 기반으로 각 사용자에 맞춰 추천하는 것

콘텐츠 기반 개인화 추천 : 나이, 거주지 등의 프로필 정보 기반으로 그에 맞는 아이템 그룹 설계

사용자와 아이템의 인터랙션 기반 개인화 추천 : 협조 필터링 등의 방법 사용하여 과거 행동 이력으로부터 추천 아이템 계산 → 이 시스템은 사용자의 흥미, 기호 실시간으로 반영하기에 클릭, 구입 예측 성능 ↑

### 1.3.3 출력 (추천 결과 제시)
어떤 제시 방법을 사용하느냐에 따라 사용자의 행동을 이끌어내거나 그렇지 않을 수도 있다. 

## 1.4 검색 시스템과 추천 시스템
추천 시스템 개발 시 검색 시스템과의 역할 차이는 무엇인가?

### 1.4.1 검색 시스템
검색 시스템 : 키워드를 입력해서 원하는 문장을 찾아내는 기술 (페이지랭크 기술 사용)

### 1.4.2 검색 시스템과 추천 시스템 비교
검색 시스템과 추천 시스템은 다른 목적으로 사용한다.

전자를 **Pull 타입**, 후자를 **Push 타입**으로 설명한다.

![image](https://github.com/user-attachments/assets/60acb69f-3734-46ca-8aee-8122f5146d6d)

검색과 추천은 서로 협력할 필요가 있음 (사용자가 특정 키워드로 검색 후 아이템 페이지 열람 시 다른 아이템을 같이 추천하게끔 표시)

이 두 시스템을 어떻게 조합할 것인지는 비즈니스 모델, 사용자 경험 설계에 따라 상이

# CH2. 추천 시스템 프로젝트
## 2.1 추천 시스템 개발에 필요한 3가지 스킬
![image](https://github.com/user-attachments/assets/266370ad-0225-448b-827a-b535edcdff4e)

**비즈니스 문제 해결 능력**

*추천 시스템 목적부터 명확히 하자*

왜 추천 시스템을 쓰는지, 어떤 사용자 행동을 유도할지 정해야 함.

→ KGI/KPI 설정이 핵심 

KGI : 최종 목표 달성 여부를 측정하는 지표

KPI : 과정상의 성과 지표. KGI 달성을 위한 중간 목표

(추천 시스템을 도입함으로써 사용자의 어떤 행동 변화를 기대하는가)

클릭률, 시청 시간 등 목표 행동을 수치로 정리해야 함.

KPI는 사용자 행동을 잘 이해한 후 정해야 효과적.

*데이터보다 본질이 중요*

현재 있는 데이터에만 의존하지 말고, 필요한 로그는 새로 만들어서라도 확보해야 함.

**데이터 사이언스 능력**

이상적인 시스템이 아닌, 실제 구현 가능한 추천 시스템을 만드는 것이 중요함

→ 비즈니스와 잘 소통하며 현실성과 성능을 고려해야 함.

1. Python, SQL 등을 활용해 데이터를 가공하고 추천 알고리즘을 구현해야 함.

2. 단순한 추천은 SQL만으로도 가능, 복잡한 추천은 Python 등 고급 기술 요구.
 
3. 범용 알고리즘을 사용하거나, 필요한 경우 직접 개선해 적용할 수 있어야 함.

4. 협업 필터링, 콘텐츠 기반 추천, 하이브리드 방식 등 다양하게 고려해야 함.

**데이터 엔지니어링 능력**

추천 시스템을 실제 서비스에 조합 時 다양한 비즈니스 요건 고려하여 구현 & 시스템을 안정적으로 가동시켜야 함

→ 이를 위해 계산이 빠르게 완료되도록 처리를 병렬화 or 데이터베이스 설계 & 튜닝 필요, 추천 시스템에 사용하는 데이터를 가공, 추천 목록 작성 연산 수행, 추천 목록을 데이터베이스에 저장하는 파이프라인을 조정해야 함

## 2.2 추천 시스템 프로젝트 진행 방법

위 3가지 역량을 가진 사람 or 팀이 협업하여 프로젝트를 진행하는 7단계

1. 과제 정의

2. 가설 수립

3. 데이터 설계/수집/가공

4. 알고리즘 선정

5. 학습/파라미터 튜닝

6. 시스템 구현

7. 평가 및 개선

### 2.2.1 과제 정의
비즈니스 상의 목적을 명확히 하는 단계

비즈니스 지표 (KPI) 결정 후, KPI의 목표와 현재의 차이를 확인 & 적절한 조치 검토

이 과정에서는, 목표 달성을 위해 무엇을 늘릴 수 있는지 분석 : 정량적 분석 (데이터 사용) | 정성적 분석 (인터뷰)

→ 데이터와 사용자 인터뷰를 모두 활용하여 현재 상태의 과제 정확도 향상 및 비즈니스 목표 달성을 위한 각 과제의 중요도를 결정함

### 2.2.2 가설 수립
각 과제를 해결하는 방법에 대해, 이를 실현하기 위한 비용을 검토하고 **비용 대비 효과**가 높은 이니셔티브부터 실행 → 분석 시 비용 대비 효과가 낮다면, 굳이 추천 시스템 도입하지 않고 검색 기능을 확장해도 개선 가능

### 2.2.3 데이터 설계/수집/가공
현재 어떤 데이터가 축적되어 있는지 정리하는 과정

추천 시스템 개발에 필요한 데이터

✓ 사용자와 (프로필 정보) 아이템의 (아이템 설명문, 태그, 카테고리 등) 콘텐츠 정보

✓ 사용자와 아이템의 인터랙션 정보 (열람, 북마크, 구입, 시청, 평가 등)

자사 서비스가 어떤 데이터를 갖고 있는지 정리 & 그 데이터로 추천 시스템을 구축할 수 있는지 검토

### 2.2.4 알고리즘 선정
어떤 추천 알고리즘을 사용할지 결정하는 단계 → (알고리즘 계산 시간, 필요한 데이터, 요구되는 예측 정확도 등 다양한 관점에서 비즈니스 목표에 적합한 것 선택)

**알고리즘의 정확도-비용 그래프**

![image](https://github.com/user-attachments/assets/3d1efc7c-9cbb-48ca-ac36-2ccf7a155072)

### 2.2.5 학습/파라미터 튜닝
추천 시스템의 학습과 튜닝 수행 및 실제 서비스로 출시하기 전 과거 데이터를 사용하여 온라인으로 추천시스템의 적정성 검증

→ 검증 시, 머신러닝 지표도 중요하나 이 아이템을 넣으면 어떤 아이템이 나오는지 확인하고 그 결과가 납득되는지 확인하는 것이 중요

온라인에서 검증 시 데이터 편향에 주의하여, 편향 제거 후 추천 시스템을 만들어 평가해야 함

### 2.2.6 시스템 구현
온라인에서 좋은 추천 알고리즘 완성 후, 실제 시스템에 조합하는 단계

**배치 추천** : 정해진 시점에 해당 시점의 정보를 기반으로 추천 목록을 업데이트하여 사용자에게 제공하는 방법

추천목록은 추천 모델 학습, 추천 모델에 의한 예측의 2단계 처리를 통해 작성됨

**실시간 추천** : 사용자의 직전 행동 이력을 즉시 반영하여 추천 목록을 생성하는 방법. 

### 2.2.7 평가 및 개선
추천 기능 출시 및 실제로 효과가 있는지 검증하는 단계

1. A/B 테스트 같은 구조로 일부 사용자에게만 추천 기능을 제공 → 추천했을 때와 그렇지 않을 때 사용자의 행동 검증

2. A/B 테스트 어려운 경우 시계열에 따른 트렌드를 고려하여 출시 전후를 비교하여 평가

또한, 시스템 전체를 보고 악영향이 없는지 확인하는 것도 중요함 (추천 시스템의 매출 증가만 보지 말고, 검색 시스템은 어떤 변화가 있는지까지 전체적으로 따져야 함)

이러한 과정을 반복하여 처음 수립했던 가설을 검증한다.

# CH3. 추천 시스템의 UI/UX
의사결정을 지원하는 시스템이 기능하기 위해 제공해야 할 UI(어떤 화면)/UX(어떤 체험)는 무엇인가?
## 3.1 UI/UX의 중요성
고도화된 추천 알고리즘을 사용하여 사용자에게 가치 있는 아이템 선택 기회를 제공 → 최적의 형태로 전달해야 함 (의사 결정 지원)

본 장에서는 추천 시스템을 활용하는 서비스의 특징적인 UI/UX에 대한 소개를 다룰 예정
## 3.2 서비스를 사용하는 사용자의 목적에 적합한 UI/UX 사례
서비스를 사용하는 사용자 측의 목적 분류

1. 적합 아이템 발견

: 사용자가 자신의 목적 달성에 적합한 아이템을 서비스 상에서 최소 1개 이상 발견하는 경우

2. 적합 아이템 나열

: 사용자가 자신의 목적을 달성하는 데 적합한 아이템을 가능한 모든 서비스에서 발견하는 경우

3. 아이템 계열 소비

: 열람, 소비하는 동안 추천된 아이템 계열 전체에서 가치를 누리는 것을 목적으로 하는 경우

4. 서비스 내 체류

: 사용자가 사용하는 서비스 본래의 목적을 달성 X, 아이템을 열람하는 것 자체를 목적으로 서비스 안을 돌아다니는 경우

## 3.3 서비스 제공자의 목적에 맞는 UI/UX 사례
서비스 제공자 측의 대표적인 비즈니스 목적

1. 신규/사용 빈도가 낮은 사용자의 정착

개요 추천 : 서비스 내 데이터 통계 정보나 서비스 지식이 풍부한 편집자의 선택을 기반으로 추천하는 기술

→신규 & 사용 빈도 少 사용자에게 좋은 경험 제공 및 나쁜 경험 방지

2. 서비스에 대한 신뢰성 향상

사용자 평가 : 서비스 안의 사용자 사이에서 추천을 구현하는 기술

→ 다른 사용자의 '살아있는 목소리'를 참고하도록 하여 좋은 경험을 제공하는 서비스를 인정받음 (스팸리뷰는 필터링을 한다.)

3. 사용 빈도 향상 및 이탈 사용자의 복귀

알림 서비스 : 사용자가 서비스를 이용하지 않을 때 메일, 푸시 알림 등의 방법으로 추천 보내는 것

4. 교차 판매

교차 판매 : 어떤 상품의 구매를 검토하고 있는 사용자에게 다른 상품을 함께 또는 개별적으로 구입하도록 함으로써 단가를 높이는 방법

**연관 아이템 추천** : 교차 판매를 구현하는 효과적인 수단

5. 장기적으로 사용자의 충성도 향상

장기적으로 충성도를 높여 서비스를 계속 이용하도록 만드는 것이 중요하다!

개인화 : 서비스 내에서 수집한 사용자 정보나 행동 이력을 활용하여 그 사람에게 맞는 아이템을 추천하는 개인화된 추천 결과 제공하는 형태

: 이는 사용자 정보가 축적되어 일정 수준 이상의 정확도가 보장된 형태일 때만 사용해야 함. 너무 남발하면 ㅈ됨

## 3.4 연관 주제
UI/UX와 깊이 연관된 주제는 무엇이 있는가?
### 3.4.1 아이템의 유사도
사용자의 과거 행동 이력을 통해 적합한 아이템을 추천하는 경우 : 아이템 사이의 관계성 고려하여 추천할 아이템 설정하는 방법 有

유사도는 사용자의 필요에 따라 설계되어야 한다.

### 3.4.2 신선함, 흥미로움, 다양성
사용자가 관심을 보이면서도 알지 못하거나 (신선함), 예상치 못한 의외성이라는 요소가 더해지거나 (흥미로움), 추천된 여러 아이템이 서로 비슷하지 않거나(다양성)

### 3.4.3 추천 아이템 선별
사용자의 기분 안상하게 선별 ㅋㅋ

### 3.4.4 추천 이유 제시
추천 이유 제시를 통한 추천 효과, 추천의 투명성, 사용자 만족도 향상

# CH4. 추천 알고리즘 개요
추천할 아이템을 선택하기 위해 시스템에 축적된 사용자의 선호 정보, 아이템의 콘텐츠 정보 등 다양한 데이터에 기반하여 사용자가 어떤 아이템을 좋아하는지 계산하는 알고리즘 : **프로세스(추천 설계)**

## 4.1 추천 알고리즘 분류











