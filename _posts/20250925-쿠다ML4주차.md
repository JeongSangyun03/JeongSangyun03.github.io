---
layout : post
title : 메타러너
categories : 쿠다ML심화
---
## 메타러너
메타러너 : 기존의 예측 머신러닝 알고리즘을 활용해서 처치효과를 추정하는 방법 (고차원 데이터 처리를 잘 하기에 CATE 추정에 흔히 사용됨)

### 이산형 처치 메타러너

#### T 러너
T-러너는 처치군(treated)과 대조군(control)을 완전히 분리해서 각각의 결과모형을 따로 학습하는 메타러너 방법

<img width="400" height="300" alt="image" src="https://github.com/user-attachments/assets/60305f62-f4c3-456a-a6ea-36e2d9f1853e" />

장점: 구현이 단순하고, 서로 다른 모형을 유연하게 쓸 수 있음.

단점: 처치군과 대조군 데이터가 한쪽으로 불균형하거나 표본 수가 적으면, 두 모형의 성능 차이 때문에 ITE 추정이 불안정해짐.

<img width="500" height="596" alt="image" src="https://github.com/user-attachments/assets/5e783ee1-566c-4edb-8211-8c86a97a3549" />

위와 같이 처치군 데이터가 대조군 데이터보다 적을 때, leaf node를 고정했다면 적은 데이터를 담는 집단은 추정이 불안정해진다. 고로 가정했던 일정한 처치결과와 달리 두번째 그래프처럼 추정된 CATE가 저렇게 비선형 곡선으로 나오게 될 것이다.

그래서 발생하는 문제: 실제 처치효과가 일정(공변량에 관계 없이 Y(1) - Y (0) 일정)해도, 마치 𝑋에 따라 변하는 것처럼 잘못 추정될 수 있음

이 문제 해결을 위한 대안: X 러너

#### X 러너
X-러너는 이 문제를 해결하려고 “관측되지 않은 잠재적 결과를 보간(imputation)” 하는 과정을 거침.

처치군(T=1)에게는 실제로 Y(1)만 관측되므로, 누락된 Y(0)을 대조군 모델로 예측해서 채움.

대조군(T=0)에게는 실제로 Y(0)만 관측되므로, 누락된 Y(1)을 처치군 모델로 예측해서 채워 넣음. 

즉, 각 집단에서 누락된 잠재적 결과를 추정 → 개별 ITE를 계산할 수 있게 함.

대조군/실험군 각각 따로 모델을 학습 → 각 집단의 데이터 분포가 다르고, 데이터 수 자체도 불균형한 경우가 많음.

대조군은 데이터가 많아도 실제 처치 상황을 대표하지 못할 수 있음

실험군은 데이터가 적어서 과적합·편향 위험이 큼

따라서 한쪽 집단에서 훈련한 모델이 “망가진 모델”이 될 수 있음.

<img width="1088" height="357" alt="image" src="https://github.com/user-attachments/assets/7fe9e862-7c48-4647-aa0c-93da484a5e1a" />

이후 성향점수를 적용하여 CATE 가중치 부여
<img width="792" height="555" alt="image" src="https://github.com/user-attachments/assets/a2bfc67f-e91a-4d59-9c3a-cdbe389809ab" />


