---
layout : post
title : 쿠다ML 1주차
categories : 데이터비즈니스
---
## CH2. 데이터와 표본분포

**용어 정리**

| 용어 | 영어 | 정의 |
|------|------|------|
| 표본 | sample | 더 큰 데이터 집합으로부터 얻은 부분집합 |
| 모집단 | population | 어떤 데이터 집합을 구성하는 전체 대상 혹은 전체 집합 |
| N(n) | - | 모집단(표본)의 크기 |
| 임의표본추출 (임의표집, 랜덤표본추출) | random sampling | 무작위로 표본을 추출하는 것 |
| 층화표본추출 (층화표집) | stratified sampling | 모집단을 층으로 나눈 뒤, 각 층에서 무작위로 표본을 추출하는 것 |
| 계층 | stratum (복수형 strata) | 공통된 특징을 가진 모집단의 동종 하위 그룹 |
| 단순임의표본 (단순랜덤표본) | simple random sample | 모집단 층화 없이 임의표본추출로 얻은 표본 |
| 편향 | bias | 계통상의 오류 |
| 표본편향 | sample bias | 모집단을 잘못 대표하는 표본 |

샘플 기반의 추정이나 모델링에서 데이터 품질은 데이터 양보다 더욱 중요!

데이터 품질 : 완결성, 형식의 일관성, 깨끗함 및 각 데이터 값의 정확성 의미

데이터 수집 시 통계적 편향은 측정과정 or 표본 추출 과정에서 생길 수 있음

임의 표본 추출로 인한 오류 : 표본마다 값이 달라서 생기는 오류

편향에 따른 오류 : 설계 상의 오류

**크기와 품질 : 크기는 언제 중요해질까?**

데이터의 크기와 품질을 결정할 때, 크기는 찾고자 하는 데이터가 희소할 때 중요해진다.

**통계학에서의 표본분포**

| 용어             | 영어 표현                  | 정의                                                                                  |
|------------------|---------------------------|---------------------------------------------------------------------------------------|
| 표본통계량       | sample statistic          | 더 큰 모집단에서 추출된 표본 데이터들로부터 얻은 측정 지표                            |
| 데이터 분포      | data distribution         | 어떤 데이터 집합에서의 각 개별 값의 도수분포                                          |
| 표본분포         | sampling distribution     | 여러 표본들 혹은 재표본들로부터 얻은 표본통계량의 도수분포                            |
| 중심극한정리     | central limit theorem     | 표본크기가 커질수록 표본분포가 정규분포를 따르는 경향                                  |
| 표준오차         | standard error            | 여러 표본들로부터 얻은 **표본통계량의 변량** (개별 데이터 값들의 변량을 뜻하는 **표준편차와 혼동하지 말 것**) |

표본통계량으로 어떤 것을 측정하거나 무언가를 모델링하기 위해 표본을 뽑는다. 여기서 우리의 주요 관심사는 **표본의 변동성**

표본이 클수록 표본통계량의 분포가 좁아진다 -> **중심 극한 정리** : 표본크기가 충분하고 데이터가 정규성을 크게 이탈하지 않는 경우, 여러 표본에서 추출한 평균은 종 모양의 정규 곡선을 따름

전통적인 신뢰구간 계산(예: z-검정, t-검정)은 표본평균이 정규분포를 따른다는 중심극한정리를 전제로 함.

그런데 실제 데이터는 왜도가 크거나, 분산이 일정하지 않거나, 표본수가 작을 때 정규 근사가 잘 안 맞을 수 있음.

**부트스트랩**은 그냥 데이터 자체를 재표본하므로 분포 가정을 거의 하지 않아도 됨 → 비모수적 방법.

부트스트랩을 이용하면 새로운 샘플을 뽑을 필요 X (실제로 이 과정은 고난이도, 비효율적)

**부트스트랩**은 배깅, 랜덤포레스트 등의 앙상블을 통해 트리의 안정성과 정확성을 높이는 도구로 쓰일 수 있음. 

**재표본추출 VS 부트스트래핑**

재표본추출 (복원, 비복원 추출 개념 포함) 

→ 복원 추출 : 부트스트랩 (표본 통계량의 변동성 평가하는 강력한 도구)

→ 비복원 추출 : 교차검증, 퍼뮤테이션 테스트 (예측성능 평가 도구)

**신뢰 구간** : 표본추출의 불확실성(=표본 오차) 때문에 필요한 지표 (ex : 평균들의 분포가 대략 어느 범위에 모여 있다.)

부트스트랩 신뢰구간의 장점

1. 분포 가정 불필요

2. 복잡한 통계량에도 적용 가능

3. 작은 표본에서도 활용 가능

4. 계산만 충분히 하면 정밀도 ↑

5. 직관적으로 이해 가능

<img width="400" height="491" alt="image" src="https://github.com/user-attachments/assets/84b58d98-941b-4866-8ac6-7c77de4418a6" />

신뢰구간과 관련된 백분율 : 신뢰수준

신뢰수준이 높을수록, 표본이 작을수록 구간이 더 넓어진다.

**신뢰구간과 구간 폭 해석 정리**

| 상황                         | 구간 폭 변동 | 의미 해석 |
|------------------------------|-------------|-----------|
| 🔼 **신뢰수준이 높아질 때** (90% → 95% → 99%) | 넓어짐 | 더 많은 확신을 담기 위해 **보수적으로 구간을 넓힘** → 불확실성이 커진 게 아님 |
| 🔽 **표본 크기가 작을 때** (n ↓)            | 넓어짐 | 표본 자체의 **변동성이 커짐** → 실제로 불확실성이 커짐 |

---

**정리:**  
- **신뢰수준↑ → 구간 넓어짐 = 확신 ↑ (보수적 추정)**  
- **표본크기↓ → 구간 넓어짐 = 불확실성 ↑ (데이터 한계)**  

**정규분포** : 불확실성과 변동성에 관한 수학적 근사가 가능하도록 하는 기여를 한 분포.

<img width="200" height="410" alt="image" src="https://github.com/user-attachments/assets/ceb59c2d-7f30-41ca-90c8-783ca88da5e7" />

=> 그러나, 데이터는 일반적으로 정규분포를 따르지 않는다. 

분포가 소득 데이터와 같이 비대칭적으로 기울어져 있거나, 이항 데이터와 같이 이산적일 수 있으며, 이는 모두 **긴 꼬리 분포**가 될 수 있음

(긴 꼬리를 잘 들여다보는 것을 실무에서는 중요하게 여긴다. 적은 수의 극단 값이 주로 존재하는 부분이기에)

<img width="200" height="406" alt="image" src="https://github.com/user-attachments/assets/0253151a-58aa-4b77-aee7-cb13e8ca4071" />

**t-분포** : 정규분포와 비슷하나 꼬리가 더 두꺼운 형태로, 표본평균, 두 표본평균 사이의 차이, 회귀 파라미터 등의 분포를 위한 기준으로 널리 사용됨

**이항 분포** : 각 시행마다 성공 확률이 정해져 있을 때, 주어진 시행 횟수 중에서 성공한 횟수의 도수분포

=> 선택에 있어 중요한 결정 사항들을 나타내므로 모델을 만드는 데 매우 중요.

**카이제곱분포** : 범주에 속하는 주제 또는 항목에 대해 귀무 기댓값에서 벗어난 정도를 측정

**F분포** : 측정된 데이터와 관련한 실험 및 선형 모델에 사용되며, 이 통계량은 관심 요인으로 인한 변동성과 전체 변동성을 비교

**포아송 분포** : 시간별, 공간별로 사건 발생이 얼마나 다른지 알고 싶을 때 알려주는 분포

**지수분포** : 사건이 발생하는 시간에 대한 정보를 알고 싶을 때 사용

## CH3. 통계적 실험과 유의성검정

**A/B 검정** : 두 가지 방법(A안 vs B안)을 비교해서 어느 쪽이 더 효과적인지 확인하는 실험적 방법.

대조군 : 비교를 위한 기준이 되는 집단

=> 기존 방법이거나, 아예 아무런 처리도 적용하지 않는 방법

<img width="500" height="810" alt="image" src="https://github.com/user-attachments/assets/50fc7025-674f-4d57-8fcb-b40836717517" />

| 용어            | 영어 표현              | 정의                                                                 |
|-----------------|-----------------------|----------------------------------------------------------------------|
| 처리           | treatment             | 어떤 대상에 주어지는 특별한 환경이나 조건 (약, 가격, 인터넷 뉴스 제목) |
| 처리군 (처리 그룹) | treatment group        | 특정 처리에 노출된 대상들의 집단                                     |
| 대조군 (대조 그룹) | control group          | 어떤 처리도 하지 않은 대상들의 집단                                   |
| 임의화 (랜덤화) | randomization         | 처리를 적용할 대상을 임의로 결정하는 과정                             |
| 대상           | subject               | 처리를 적용할 개체 대상 (유의어: 피실험자)                            |
| 검정통계량      | test statistic        | 처리 효과를 측정하기 위한 지표                                        |

**가설 검정** : 관찰된 효과가 우연에 의한 것인지 여부를 알아내는 것

| 용어        | 영어 표현              | 의미/설명                                                                 |
|-------------|------------------------|----------------------------------------------------------------------------|
| 귀무가설    | null hypothesis        | 우연 때문이라는 가설 (유의어: 영가설)                                      |
| 대립가설    | alternative hypothesis | 귀무가설과의 대조 (증명하고자 하는 가설)                                   |
| 일원검정    | one-way test           | 한 방향으로만 우연히 일어날 확률을 계산하는 가설검정                        |
| 이원검정    | two-way test           | 양방향으로 우연히 일어날 확률을 계산하는 가설검정                          |

**귀무가설 VS 대립가설**

: 실험에서 A그룹과 B그룹 차이가 났다면, 그 차이가 우연의 산물인지, 실제 효과인지 판단해야 함.

그래서 "무작위로 얻을 수 있는 수준과는 극단적으로 다르다"는 증거(p-value, 유의수준)를 확보해야만 "효과 있다"라고 주장할 수 있음.

가설검정 : 실험에서는 무작위로도 일어날 수 있는 범위를 먼저 기준으로 설정 후, 그룹 간의 차이는 우연이라고 가정 (귀무가설)/ 이를 뒤집을 만큼 강력한 증거가 있을 때 효과가 있다고 말할 수 있음 (대립 가설)

**일원/이원 가설검정**

: 대립 가설에서 방향성을 어떻게 두느냐에 따라 일원 vs 이원 검정이 나뉨

| 구분        | 귀무가설(H₀) | 대립가설(H₁)         | 검정 방향      | 예시             |
| --------- | -------- | ---------------- | ---------- | -------------- |
| **일원 검정** | μ = μ₀   | μ > μ₀ 또는 μ < μ₀ | 한쪽(좌 or 우) | “신제품이 기존보다 낫다” |
| **이원 검정** | μ = μ₀   | μ ≠ μ₀           | 양쪽 모두      | “신제품이 기존과 다르다” |

**귀무가설을 기각할지 말지 결정하게 하는 검정법**

임의순열검정 : 귀무가설을 세운 후, 데이터 라벨을 무작위로 섞어 수천 번 시뮬레이션하고, 실제 차이가 그 “우연 분포” 속에서 얼마나 극단적인지를 보는 방식

=> 가정이 필요 없는 유연한 통계적 유의성 검정 도구

| 구분  | 전체순열검정           | 임의순열검정                   |
| --- | ---------------- | ------------------------ |
| 방식  | 가능한 모든 분할 조합을 계산 | 일부만 무작위 샘플링              |
| 계산량 | 정확하지만 계산 폭발 위험   | 근사적이지만 계산 효율적            |
| 결과  | "정확한 p-value"    | "근사 p-value" (확률적 오차 존재) |

| 구분      | 순열검정         | 부트스트랩 검정            | 부트스트랩 순열검정                         |
| ------- | ------------ | ------------------- | ---------------------------------- |
| 재표본화 방식 | 레이블 섞기 (비복원) | 복원추출                | 복원추출 후 레이블 섞기 or 섞는 과정을 부트스트랩으로 반복 |
| 귀무분포    | “라벨 무의미” 분포  | “데이터가 모집단 대표” 가정 분포 | 두 아이디어 혼합                          |
| 특징      | 정확하지만 조합 폭발  | 신뢰구간·분포 추정에 강점      | 작은 표본/이산적 분포에서 유연성 확보              |

부트스트랩 순열검정은 모집단에서 개체 선택시 임의성 보장 & 개체가 처리군에 할당될 때에도 임의성 보장

**통계적 유의성과 p-value**

통계적 유의성 : 통계학자가 자신의 실험 결과가 우연히 일어난 것인지, 우연히 일어날 수 없는 극단적인 것인지 판단하는 방법

- **p 값 (p-value)**  
  귀무가설을 구체화한 기회 모형이 주어졌을 때 관측된 결과와 같이 특이하거나 극단적인 결과를 얻을 확률

- **알파 (α, 유의수준)**  
  실제 결과가 통계적으로 의미 있는 것으로 간주되기 위해, 우연에 의한 결과가 능가해야 하는  
  *‘비정상적인’ 가능성의 임계 확률*

- **제1종 오류 (Type I error)**  
  우연에 의한 효과를 실제 효과라고 잘못 결론 내리는 것

- **제2종 오류 (Type II error)**  
  실제 효과를 우연에 의한 효과라고 잘못 결론 내리는 것

  
