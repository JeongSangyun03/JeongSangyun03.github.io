---
layout: post
title:  "01. 분류"
date:   2025-01-19
categories: ['ML기초']
---
# 쿠다 ML 기초 1주차
## 3.1 MNIST
이 장에서는 분류 시스템을 집중적으로 다루어 보려고 한다. 

**(사실대로 말하면 사이킷런에 있는 데이터를 불러올 수 없어서 교재에 나온 코드를 모방하고, 개념과 수식 위주로 정리하려고 한다.)**

MNIST 데이터셋이란 고등학생과 미국 인구 조사국 직원들이 손으로 쓴 70000개의 작은 숫자 이미지이다. 각 이미지에는 어떤 숫자를 나타내는지 레이블이 되어있고, 머신러닝 학습을 위한 유용한 데이터로 활용된다.
이는 사이킷런에서 제공하는 여러 헬퍼 함수를 사용하여 잘 알려진 데이터셋을 내려받을 수 있다.
다음은 OpenML.org에서 MNIST 데이터셋을 내려받는 코드이다.

```python
from sklearn.datasets import fetch_openml
mnist = fetch_openml('mnist_784',as_frame = False)
```
여기서 as_frame = False를 사용하는 이유는 다음과 같다. sklearn.datasets 패키지에 있는 함수 중 fetch_openml()과 같이 실전 데이터셋을 다운로드하는 함수는 기본적으로 입력을 판다스 데이터프레임, 레이블을 판다스 시리즈로 반환하는데, MNIST 데이터셋은 이미지이므로 데이터프레임이 잘 맞지 않는다. 그러므로 as_frame = False로 지정하여 넘파이 배열로 데이터를 받는다.
```python
X,y = mnist.data, mnist.target
import matplotlib.pyplot as plt
def plot_digit (image_data) :
  image = image_data.reshape(28,28)
  plt.imshow (image, cmap = 'library')
  plt.axis ('off')
some_digit = X[0]
plot_digit (some_digit)
plt.show()
```
(이미지)
이 그림은 숫자 5로 보인다. 실제 레이블을 확인하면
```python
print (y[0])
```
결괏값이 5로 출력됨을 알 수 있다.
데이터 섞기는 모델 학습에서 매우 중요한 과정이다. 데이터를 섞지 않으면 훈련 세트와 검증 세트에 특정 클래스(레이블)가 편향될 가능성이 있다. 예를 들어, MNIST 데이터셋에서 0-9 숫자의 샘플이 순차적으로 나열되어 있다면 초반 샘플에는 주로 0,1이 많고 후반에는 8,9가 몰려 있을 수 있다. 따라서 교차 검증에서 각 폴드에 모든 클래스가 골고루 포함되도록 데이터를 섞어 공정성을 확보해야 한다. 또한, 데이터를 섞지 않고 폴드를 나눈다면 특정 폴드에 어떤 클래스가 전혀 포함되어 있지 않아 모델이 학습할 기회를 갖지 못해 부정확한 결과를 낼 수 있다. 
그러므로, 데이터를 섞어 클래스 분포를 균일하게 만들고 훈련 안정성을 증가시켜야 한다. 
MNIST 데이터에서는 훈련 세트 (앞쪽 60000개 이미지)와 테스트 세트 (뒤쪽 10000개 이미지)로 구성되어 있다. 
훈련세트 : 모델을 학습시키기 위해 사용
테스트 세트 : 모델이 학습하지 않은 데이터로 성능 평가
그러나 모든 데이터가 이렇게 나누어져 있는 것은 아니기에, 데이터 조사 전에 항상 테스트 세트를 만들고 따로 떼어놓아야 한다. 그리하여 모델이 새로운 데이터에 대해 얼마나 일반화할 수 있는지 평가 가능하도록 만들어야 한다.

## 3.2 이진 분류기 훈련
이진 분류기 훈련은 True와 False를 구분할 수 있는 분류기이다. 분류 작업을 위해 타깃 벡터를 우선 만들고, 분류 모델을 선택하여 훈련을 시켜보려고 한다. 확률적 경사 하강법(SGD)은 이진 분류기를 학습시키는 데 사용되는 최적화 도구이다. 
다음 코드를 통해 살펴보자.
```python
y_train_5 = (y_train == '5')
y_test_5 = (y_test == '5')
from sklearn.linear_model import SGDClassifier
sgd_clf = SGDClassifier(random_state = 42)
sgd_clf.fit(X_train, y_train_5)
sgd_clf.predict([some_digit])
```
(결괏값)
분류기는 이 이미지가 5를 나타낸다고 추측하였다.

## 3.3 성능 측정
### 3.3.1 교차 검증을 사용한 정확도 측정
cross_val_score () 함수로 폴드가 3개인 k-폴드 교차 검증을 사용해 SGDClassifier 모델을 평가해보려고 한다.
k-폴드 교차 검증 : 훈련 세트를 k개의 폴드로 나누고, 평가를 위해 매번 다른 폴드를 떼어놓고 모델을 k번 훈련함

