---
layout : post
title : 쿠다2주차
categories : 데이터비즈니스
---
## 회귀와 예측
**단순 선형회귀**
# 상관관계 vs 회귀

| 구분 | 상관관계 (Correlation) | 회귀 (Regression) |
|------|------------------------|-------------------|
| 정의 | 두 변수 사이의 **관련 강도**를 측정 | 한 변수가 다른 변수에 **얼마나 영향을 주는지 정량화** |
| 해석 | “두 변수가 얼마나 같이 움직이는가?” | “X가 1 단위 변하면 Y는 평균적으로 얼마 변하는가?” |

**회귀식** : 독립변수가 변할 때 종속변수가 어떻게, 얼마나 변하는지를 수식으로 나타낸 관계식

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/86216e20-8d9b-43b8-9739-de749adc38ff" />

▶ 면전에 노출된 연수와 폐활량의 관계를 파악하기 위해 단순선형회귀 이용

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/f7b80979-8718-4765-ab72-cc28863d25ca" />

▶ 단순선형회귀는 예측변수 Exposure에 대한 함수로 응답변수 PEFR을 예측하기 위한 가장 최선의 직선을 찾으려고 시도

**적합값과 잔차**

| 기호 | 이름 | 정의 | 의미 |
|------|------|------|------|
| $$\( Y_i \)$$ | 실제값 (Observed value) | 관측된 종속변수 값 | 우리가 데이터에서 실제로 얻은 값 |
| $$\( \hat{Y}_i = \hat{b}_0 + \hat{b}_1 X_i \)$$ | 적합값 (Fitted value, 예측값) | 추정된 회귀식으로 계산된 값 | 독립변수$$ \(X_i\)$$에 따라 모델이 예측한 종속변수 |
|$$ \( e_i \) $$| 오차항 (Error term) |$$ \( Y_i = b_0 + b_1 X_i + e_i \)$$ | 실제 모형에서 설명되지 않는 부분 (이론적 개념) |
| $$\( \hat{e}_i = Y_i - \hat{Y}_i \)$$ | 잔차 (Residual) | 실제값 - 적합값 | 데이터에서 실제로 계산 가능한 예측 오차 |
| $$\( \hat{b}_0, \hat{b}_1 \) $$| 추정된 회귀계수 (Estimated coefficients) | 표본으로부터 추정된 값 | 모집단의 진짜 계수 \(b_0, b_1\)의 추정치 |

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/65de1f2e-10a0-42dd-b743-d8bc78c7a9fb" />

▶ 폐활량에 대한 회귀선으로부터 얻은 잔차 (수직으로 그은 점선들 = 잔차)

**최소제곱** : 잔차제곱을 최소화하는 방법

```
$$​min(b0,b1)_​i=1∑n​(yi​−y^​i​)2$$
```
**예측 대 설명 (프로파일링)**

| 구분 | 예측 (Prediction) | 설명 (Explanation / Profiling) |
|------|-------------------|--------------------------------|
| 목적 | 새로운 \(X\) 값으로 \(Y\)를 **정확히 맞추는 것** | \(X\)가 \(Y\)에 **어떻게, 왜 영향을 주는지 해석** |
| 관심사 | 수학적/통계적 관계식 자체 (\(Y = b_0 + b_1X\)) | 회귀계수의 의미, 변수 간 **인과·맥락 해석** |
| 평가 | RMSE, MAE, R² 같은 **예측 정확도 지표** | Adjusted R², 설명력, 인과적 타당성 |
| 특징 | 패턴 포착이 핵심, 인과 여부는 중요치 않음 | 단순 수치 이상으로 **도메인 지식** 필요 |
| 예시 | “광고비 X로 다음 달 매출 Y 예측하기” | “광고비가 매출에 영향을 주는 이유를 설명하기” |

**다중선형회귀**

*회귀식*

$$
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p + \varepsilon
$$

*적합값*

$$
\hat{Y}_i \= \hat{\beta}_0 + \hat{\beta}_1 X_{i1} + \hat{\beta}_2 X_{i2} + \cdots + \hat{\beta}_p X_{ip}
$$

*잔차*

$$
\hat{e}_i = Y_i - \hat{Y}_i
$$

R² (결정계수)와 "변동을 설명한다"는 의미

1. 기본 개념
- **총 변동 (SST, Total Variation)**  
  데이터 \(y_i\)가 평균 \(\bar{y}\) 주위에서 얼마나 퍼져 있는가  
  \[
  SST = \sum (y_i - \bar{y})^2
  \]

- **설명된 변동 (SSR, Explained Variation)**  
  모델 예측값 \(\hat{y}_i\)가 평균 \(\bar{y}\)와 얼마나 다른가 → 모델이 잡아낸 패턴  
  \[
  SSR = \sum (\hat{y}_i - \bar{y})^2
  \]

- **잔차 변동 (SSE, Unexplained Variation)**  
  실제값과 예측값의 차이 → 모델이 설명 못한 부분  
  \[
  SSE = \sum (y_i - \hat{y}_i)^2
  \]

---

2. R² 정의
\[
R^2 = \frac{SSR}{SST} = 1 - \frac{SSE}{SST}
\]

- \(R^2 = 0.8\) → 데이터 변동의 **80%를 모델이 설명**  
- \(R^2 = 0.2\) → 데이터 변동의 **20%만 모델이 설명**, 나머지는 잡지 못함  

---

3. "변동을 설명한다"는 직관적 의미
- 데이터는 평균에서 들쭉날쭉(=변동) 퍼져 있다.  
- 모델이 잡은 직선(혹은 곡선)이 점들의 **패턴**을 얼마나 잘 따라가는지가 "설명력".  
- 설명력이 높다 = 점들의 흩어진 이유를 모델이 잘 포착했다는 뜻.  

**모델 평가와 홀드아웃 샘플의 문제점**

1. 기존 지표의 한계
- R², F 통계량, p값 등은 **훈련 데이터 기준**으로 계산됨.
- 따라서 **새로운 데이터에서의 성능(일반화 능력)** 은 보장하지 못함.

2. 해결책: 홀드아웃(hold-out)
- 데이터를 **훈련(train) / 테스트(test)** 로 분리.
- 훈련 데이터로 모델을 만들고, 테스트 데이터로 성능을 검증.

3. 문제점
- **테스트 세트가 작으면** 샘플 편차가 커짐 → 성능 지표가 불안정.
- 즉, 모델의 **진짜 성능과 측정된 성능 간 오차(불확실성)** 이 커질 수 있음.

4. 대안
- 교차검증(K-fold CV) : 데이터를 k개로 나누고, 각 부분을 번갈아가며 Test set로 활용하는 것을 의미한다.

**모형 선택 및 단계적 회귀** : 많은 변수를 추가한다고 해서 꼭 더 좋은 모델을 얻는 것인가? (X)

비교
| 기준 | R² | 수정 R² | AIC |
|------|-----|---------|-----|
| 의미 | 설명된 변동 비율 | R² + 자유도 보정 | 적합도 vs 복잡도 균형 |
| 해석 | 값 ↑ → 좋음 | 값 ↑ → 좋음 | 값 ↓ → 좋음 |
| 변수 추가 효과 | 항상 좋아짐 | 유효한 변수만 좋아짐 | 복잡도에 따라 불이익 |
| 한계 | 과적합 착시 | 여전히 훈련 데이터 기반 | 절대적 의미 없음, 비교만 가능 |

---



- **R²**: 단순 설명력 (변수 추가하면 착시 발생)  
- **수정 R²**: 변수 추가에 패널티 반영, 유효 변수만 인정  
- **AIC**: 잔차 크기와 변수 수를 함께 고려, 값이 작을수록 좋은 모델  

