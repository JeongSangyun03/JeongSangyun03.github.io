---
layout : post
title : 쿠다2주차
categories : 데이터비즈니스
---
## 회귀와 예측
**단순 선형회귀**
# 상관관계 vs 회귀

| 구분 | 상관관계 (Correlation) | 회귀 (Regression) |
|------|------------------------|-------------------|
| 정의 | 두 변수 사이의 **관련 강도**를 측정 | 한 변수가 다른 변수에 **얼마나 영향을 주는지 정량화** |
| 해석 | “두 변수가 얼마나 같이 움직이는가?” | “X가 1 단위 변하면 Y는 평균적으로 얼마 변하는가?” |

**회귀식** : 독립변수가 변할 때 종속변수가 어떻게, 얼마나 변하는지를 수식으로 나타낸 관계식

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/86216e20-8d9b-43b8-9739-de749adc38ff" />

▶ 면전에 노출된 연수와 폐활량의 관계를 파악하기 위해 단순선형회귀 이용

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/f7b80979-8718-4765-ab72-cc28863d25ca" />

▶ 단순선형회귀는 예측변수 Exposure에 대한 함수로 응답변수 PEFR을 예측하기 위한 가장 최선의 직선을 찾으려고 시도

**적합값과 잔차**

| 기호 | 이름 | 정의 | 의미 |
|------|------|------|------|
| $$\( Y_i \)$$ | 실제값 (Observed value) | 관측된 종속변수 값 | 우리가 데이터에서 실제로 얻은 값 |
| $$\( \hat{Y}_i = \hat{b}_0 + \hat{b}_1 X_i \)$$ | 적합값 (Fitted value, 예측값) | 추정된 회귀식으로 계산된 값 | 독립변수$$ \(X_i\)$$에 따라 모델이 예측한 종속변수 |
|$$ \( e_i \) $$| 오차항 (Error term) |$$ \( Y_i = b_0 + b_1 X_i + e_i \)$$ | 실제 모형에서 설명되지 않는 부분 (이론적 개념) |
| $$\( \hat{e}_i = Y_i - \hat{Y}_i \)$$ | 잔차 (Residual) | 실제값 - 적합값 | 데이터에서 실제로 계산 가능한 예측 오차 |
| $$\( \hat{b}_0, \hat{b}_1 \) $$| 추정된 회귀계수 (Estimated coefficients) | 표본으로부터 추정된 값 | 모집단의 진짜 계수 \(b_0, b_1\)의 추정치 |

<img width="400" height="482" alt="image" src="https://github.com/user-attachments/assets/65de1f2e-10a0-42dd-b743-d8bc78c7a9fb" />

▶ 폐활량에 대한 회귀선으로부터 얻은 잔차 (수직으로 그은 점선들 = 잔차)

**최소제곱** : 잔차제곱을 최소화하는 방법

```
$$​min(b0,b1)_​i=1∑n​(yi​−y^​i​)2$$
```
**예측 대 설명 (프로파일링)**

| 구분 | 예측 (Prediction) | 설명 (Explanation / Profiling) |
|------|-------------------|--------------------------------|
| 목적 | 새로운 \(X\) 값으로 \(Y\)를 **정확히 맞추는 것** | \(X\)가 \(Y\)에 **어떻게, 왜 영향을 주는지 해석** |
| 관심사 | 수학적/통계적 관계식 자체 (\(Y = b_0 + b_1X\)) | 회귀계수의 의미, 변수 간 **인과·맥락 해석** |
| 평가 | RMSE, MAE, R² 같은 **예측 정확도 지표** | Adjusted R², 설명력, 인과적 타당성 |
| 특징 | 패턴 포착이 핵심, 인과 여부는 중요치 않음 | 단순 수치 이상으로 **도메인 지식** 필요 |
| 예시 | “광고비 X로 다음 달 매출 Y 예측하기” | “광고비가 매출에 영향을 주는 이유를 설명하기” |

**다중선형회귀**

회귀식

$$
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p + \varepsilon
$$

적합값

$$
\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1 X_{i1} + \hat{\beta}_2 X_{i2} + \cdots + \hat{\beta}_p X_{ip}
$$

잔차

$$
\hat{e}_i = Y_i - \hat{Y}_i
$$


