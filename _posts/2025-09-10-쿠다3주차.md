---
layout : post
title : 인과추론
categories : 쿠다3주차
---
# 인과추론
**연관관계는 인과관계인가?** : 될 수도 있고, 안될 수도 있다. 

-> 우연에 따른 상관관계일 수도 있으나, 혼동하기 쉬움

|연관관계|인과관계|
|-----|-----|
|두 개의 수치나 확률변수가 같이 움직이는 것|한 변수의 변화가 다른 변수의 변화를 일으키는 것|

: 인과추론은 연관관계로부터 인과관계를 추론하고 언제, 그리고 왜 서로 다른지 이해하는 것

**머신러닝과 인과추론** 

머신러닝은 예측 문제를 다룰 때 유용. (변수 간의 연관관계를 이용해서 변수들을 다른 변수에서 예측) -> 단순 예측 적용 시 의미 없는 결론을 내릴 수도 있음 or 과적합 가능성 다분 

: 인과추론과 머신러닝을 함께 사용해야 함

**연관관계와 인과관계**

동일한 원인이 유형에 따라 다른 영향을 미칠 수도 있음 (ex : 온라인 커머스 사이트에서 식품, 의류, 비료, 농산물 등의 다양한 상품에 가격 인하라는 처치를 내렸을 때 다른 영향을 미칠 수 있음 [기간에 따른, 이벤트에 따른])

인과추론에서의 **분석단위** : 개입(처치)하려는 대상

개입(처치) : 변화를 유발하는 원인이 되는 요소. 구하려는 효과에 대한 개입을 나타낼 때 사용하는 용어 (T or D)

인과추론의 목표는 T가 결과값 $$\ Y_i\ $$ 에 대해 미치는 영향을 학습하는 과정

**인과추론의 근본적인 문제**

: 일어나지 않은 일을 알 수 없다. (**반사실 상황**)

```
A기업이 가격 인하를 했을 때(A=treated)와 안 했을 때(A=control)를 동시에 볼 수 없다는 것.

실제로는 한 시점에서 A기업은 하나의 선택(인하 or 비인하)만 했으니, 나머지는 가정된 반사실적 결과일 뿐.
→ 따라서 관측 가능한 데이터만으로는 “가격 인하가 매출 변화에 미친 순수한 인과효과”를 알기 어려움.
```
---

**인과모델**

**인과모델(causal model)** 은 화살표(→)로 표시되는 입력의 합당 메커니즘.

- $$\( u \)$$: 모델 외부의 변수(외부변수, exogenous variable)  
- 변수 $$\( u \)$$가 어떻게 생성되었는지는 따로 설명하지 않는다.  
- $$\( u \)$$ 이외의 다른 변수들은 모두 중요하므로 모델에 포함된다.  
- 각 변수는 함수 $$\( f \)$$를 통해 다른 변수에 매핑된다.  

**구조적 인과모델 수식**

$$\[
T \leftarrow f_T(u_T)
\]
$$
$$
\[
Y \leftarrow f_Y(T, u_Y)
\]
$$

**해석**

1. 첫 번째 식: 모델링하지 않은 변수 집합 $$\( u_T \)$$ (외부변수)가 함수 $$\( f_T \)$$를 통해 **처치 변수 $$\( T \)$$** 를 유발한다.  
2. 두 번째 식: 결과 변수 $$\( Y \)$$는 **처치 변수 $$\( T \)$$** 와 외부변수 $$\( u_Y \)$$를 함께 함수 $$\( f_Y \)$$에 넣어 결정된다.  
3. 즉, 결과 $$\( Y \)$$는 단순히 처치 $$\( T \)$$에 의해서만 결정되는 것이 아니라, 모델링하지 않은 외부 요인 $$\( u_Y \)$$에도 영향을 받는다.

**모델링하지 않은 변수 집합?** 

: 머신러닝 VS 인과모델

1. 머신러닝/통계 모델

모든 독립변수들을 직접 입력 변수로 사용한다.  

$$
Y = f(X_1, X_2, \dots, X_p) + \epsilon
$$

- $$X_1, X_2, \dots, X_p$$ : 독립변수(설명변수) 집합  
- $$Y$$ : 결과변수  
- $$\epsilon$$ : 설명되지 않는 잡음  

👉 목표는 **예측 정확도**.  

---

2. 인과모델 (SCM: Structural Causal Model)

변수들을 두 가지로 구분한다.  

1. **내생변수(Endogenous)**: 모델 안에서 방정식으로 정의되는 변수  
2. **외생변수(Exogenous)**: 모델 밖에서 주어지며, 여러 요인을 묶어서 표현하는 변수  

예시: 가격 인하와 판매량  

$$
Price \leftarrow f_{Price}(u_{Price})
$$

$$
Sales \leftarrow f_{Sales}(Price, u_{Sales})
$$

- $$Price$$ : 내생변수 (처치 변수)  
- $$Sales$$ : 내생변수 (결과 변수)  
- $$u_{Price}$$ : 원가, 경쟁사 전략, 경영진 의사결정 등 (모델링하지 않은 외부 요인)  
- $$u_{Sales}$$ : 소비심리, 경기 상황 등 (모델링하지 않은 외부 요인)  

목표는 **변수들이 생성되는 구조와 인과관계**를 표현.  

---

- 머신러닝에서는: **모든 $$X$$ 들을 직접 독립변수로 투입**  
- 인과모델에서는: **여러 $$X$$ 들을 묶어서 외생변수 $$u$$ 로 처리**, 구조적 관계를 간결하게 표현


