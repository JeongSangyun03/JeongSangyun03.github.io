---
layout : post
title : 실무로 통하는 인과추론 CH5
categories : 쿠다ML심화
---
## CH5. 성향점수
이번 장에서는 성향점수 가중치를 이용하여 편향을 제거하는 방법을 살펴볼 것이다. (이진, 이산형 처치 있을 때 적합)


1. 문제 상황
- 목표: **관리자 교육(처치, T)** → **직원 참여도(결과, Y)** 인과효과 추정
- 문제: 교육 여부와 참여도에 동시에 영향을 주는 **공변량(X)** 존재 → 단순 비교 시 **편향 발생**

2. 공변량 조절의 의미
- 공변량을 모형에 포함해 **가짜 상관(비인과적 경로)** 제거
- 회귀모형 예시:
$  
\[
Y = \beta_0 + \beta_1 T + \beta_2 X + \epsilon
\]
$
- 여기서 $\(\beta_1\)$: 공변량 효과를 제거한 후 교육의 순수 효과

3. 계수 보정(Coefficient Adjustment)
- 공변량을 통제하면 $\(T\)$의 효과 계수($\$(\beta_1\$))$가 **보정된 효과**로 추정됨
- 이 과정을 흔히 **계수 보정**이라고 부름
- 다른 방법: 성향점수매칭, 층화, 가중치(IPW) 등도 가능하지만, 회귀모형에서의 조절이 가장 기본적임

**성향점수**

1. 정의
- 성향점수:
$$
e(X) = P(T=1 \mid X)
$$
공변량 $X$ 가 주어졌을 때 처치(교육)를 받을 확률.

- 조건부 독립성(CIA):
$$
(Y(0), Y(1)) \perp T \mid X
$$

<img width="400" height="150" alt="image" src="https://github.com/user-attachments/assets/5ebcdcfe-ef31-4933-a1c4-accbf7bc185d" />

2. 의미
- 공변량 $X$ 전체를 통제하는 대신, **$e(X)$** 하나로 요약해도 동일한 효과.  
- 즉, 성향점수는 **무작위 실험처럼 비교 가능**하게 해주는 도구.

3. “통제한다”의 실제 의미
- 성향점수 값 (예: $0.8$, $0.2$)을 **하나로 바꾸는 게 아님**.  
- 대신 분석에서 활용:
  - **매칭(Matching):** 비슷한 $e(X)$ 가진 처치군–통제군 비교  
  - **층화(Stratification):** $e(X)$ 구간별 층으로 나눠 비교  
  - **가중치(IPW):** $1/e(X)$ 또는 $1/(1-e(X))$ 등을 가중치로 부여해 집단 분포를 맞춤  

**성향점수 추정**




