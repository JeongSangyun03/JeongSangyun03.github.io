---
layout : post
title : 쿠다 ML 심화 2주차
categories : 쿠다 ML 심화
---
# 14. 합성곱 신경망을 사용한 컴퓨터 비전
합성곱 신경망 (CNN) : 이미지 검색 서비스, 자율 주행 자동차, 영상 자동 분류 시스템, 음성 인식, NLP 등에 사용

본 장에서는 **시각적인 애플리케이션**에 초점을 맞춤 → (CNN이 어디에서 왔는가. 구성요소는 무엇인가. 케라스로 사용하는 방법은 무엇인가.)

## 14.1 시각 피질 구조
시각 피질에 관한 연구 → **합성곱 신경망** 연구 

시각 피질에 관한 연구 중요 특징 : 

1. 시각 피질 내 많은 뉴런 : 작은 **국부 수용장** (시야의 일부 범위 안에 있는 시각 자극에 반응)
2. 동일한 수용장을 가진 뉴런 내에서도 다른 요소에 반응
3. 어떤 뉴런 : 큰 수용장을 가져 저수준 패턴 조합된 더 복잡한 패턴에 반응 (이웃한 저수준 뉴런의 출력에 기반한 고수준 뉴런)

**합성곱 신경망** 연구 : 

**LeNet-5 구조** 사용 (완전 연결 층 & 시그모이드 활성화 함수 포함 & **합성곱 층**, **플링 층** 포함)

## 14.2 합성곱 층
합성곱 층 : CNN의 가장 중요한 구성 요소

첫 번째 합성곱 층의 뉴런 : 합성곱 층 뉴런의 수용장 안에 있는 픽셀에만 연결

(☞네트워크가 첫 번째 은닉 층에서는 작은 저수준 특성에 집중. 후에 더 큰 고수준 특성으로 조합해 나감)

어떤 층 i행 j열에 있는 한 뉴런 : 이전층의 i에서 i + fh -1 까즤의 행 & j + fw - 1까지의 열에 있는 뉴런의 출력에 연결. (높이와 너비)

**제로 패딩** :높이와 너비를 이전 층과 같게 하기 위해 입력 주위에 0 추가하는 것

**스트라이드** : 한 수용장 & 다음 수용장 사이의 수평 또는 수직 방향 스텝 크기

스트라이드를 이용하여 차원 축소를 진행하고 계산 복잡도를 줄일 수 있음. (수용장 사이에 간격을 두어 큰 입력 층을 훨씬 작은 층에 연결)

(※ 스트라이드의 가로세로 크기가 동일할 수도 있고, 다를 수도 있다.)

### 14.2.1 필터
![image](https://github.com/user-attachments/assets/b2dd6380-4eab-46cb-a57f-126fa905afce)

이미지를 통해 이해해보자.

**필터** : (합성곱 커널 또는 커널이라고 불림). 이는 두 개의 가중치 세트. 

첫 번째 필터 : 가운데 흰 수직선(열이 1로 채워짐)과 그 외(열이 0으로 채워짐)가 있는 검은 사각형 (7*7 행렬 구성)

두 번째 필터 : 가운데 흰 수평선이 있는 검은 사각형

(※ 1의 특성을 가진 흰색 부분을 제외하면 수용장 안의 모든 것을 무시할 것)

층의 전체 뉴런에 적용된 하나의 필터 ==> 하나의 **특성 맵** 만듦

(훈련 중 합성곱 츠이 자동으로 해당 문제에 가장 유용한 필터를 찾고 상위 층은 이들을 연결하여 더 복잡한 패턴 학습)

### 14.2.2 여러 가지 특성 맵 쌓기
실제 합성곱 층 : 여러 가지 필터 갖고 필터마다 하나의 특성 맵 출력 (3D 출력이 일반적)

각 특성 맵의 픽셀 = 하나의 뉴런. 

뉴런 전체 집합 : 하나의 필터 => 하나의 특성 맵이므로, 하나의 특성 맵 안에서 모든 뉴런이 같은 파라미터 (동일한 가중치와 편향)을 공유. 다른 특성 맵에 있는 뉴런은 다른 파라미터 사용

하나의 합성곱 층이 입력에 여러 필터 동시 적용하여 입력에 있는 여러 특성 감지 가능

### 14.2.3 케라스로 합성곱 층 구현하기
샘플 로드 및 전처리 과정
```python
from sklearn.datasets import load_sample_images
import tensorflow as tf

images = load_sample_images()['images']
images = tf.keras.layers.CenterCrop(height=70, width=120)(images)
images = tf.keras.layers.Rescaling(scale = 1/255)(images)
```
이는 4D 텐서. (1차원 : 두 개의 샘플 이미지. 2&3차원 : 이미지 크기. 4차원 : 컬러 채널 3개)

합성곱 층 생성 + 이미지 주입 
```python
conv_layer = tf.keras.layers.Conv2D (filters = 32, kernel_size = 7)
fmaps = conv_layer(images)
fmaps.shape
```
층의 가중치 살펴보기 (커널과 편향)
```python
kernels, biases = conv_layer.get_weights()
print (kernels.shape)
print (biases.shape)
```

### 14.2.4 메모리 요구 사항
CNN : 많은 양의 RAM 필요


## 14.3 풀링 층

## 14.4 케라스로 풀링 층 구현하기

## 14.5 CNN 구조

### 14.5.1 LeNet-5

### 14.5.2 AlexNet

### 14.5.3 GoogLeNet

### 14.5.4 VGGNet

### 14.5.5 ResNet

### 14.5.6 Xception

### 14.5.7 SENet

### 14.5.8 주목할만한 다른 구조

### 14.5.9 올바른 CNN 구조 선택

## 14.6 케라스로 ResNet-34 CNN 구현하기

## 14.7 케라스의 사전 훈련 모델 사용하기

## 14.8 사전 훈련된 모델을 사용한 전이 학습

## 14.9 분류와 위치 추정

## 14.10 객체 탐지





